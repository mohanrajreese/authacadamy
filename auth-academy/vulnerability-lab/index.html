<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auth Vulnerability Lab - Learn By Exploiting</title>
    <meta name="description"
        content="Interactive security lab. Test JWT vulnerabilities, injection attacks, and learn how to defend against them.">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../shared/theme.css">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">üîì</div>
                <div>
                    <h1>Vulnerability Lab</h1>
                    <p class="subtitle">Learn Security by Breaking It</p>
                </div>
            </div>
            <nav class="header-nav">
                <a href="../index.html" class="nav-link">‚Üê Auth Academy</a>
            </nav>
        </header>

        <main class="main-content">
            <section class="intro-section glass-card">
                <div class="warning-banner">
                    ‚ö†Ô∏è Educational purposes only. Never test vulnerabilities on systems you don't own!
                </div>
                <h2>üîì Interactive Vulnerability Lab</h2>
                <p>Learn about common auth vulnerabilities by safely experimenting with them in this sandbox
                    environment.</p>
            </section>

            <!-- Lab 1: None Algorithm -->
            <section class="lab-card glass-card">
                <div class="lab-header">
                    <span class="lab-number">Lab 1</span>
                    <h3>"None" Algorithm Attack</h3>
                    <span class="difficulty hard">Advanced</span>
                </div>

                <div class="lab-description">
                    <p>The "none" algorithm attack exploits servers that don't properly validate the JWT algorithm
                        field.</p>
                </div>

                <div class="lab-demo">
                    <div class="demo-section">
                        <h4>üîê Original Token</h4>
                        <div class="token-display">
                            <code
                                id="originalToken">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwicm9sZSI6InVzZXIifQ.signature</code>
                        </div>
                        <div class="token-decoded">
                            <span class="claim">alg: "HS256"</span>
                            <span class="claim">role: "user"</span>
                        </div>
                    </div>

                    <div class="attack-section">
                        <h4>üéØ Perform Attack</h4>
                        <p>Change algorithm to "none" and modify user role:</p>
                        <div class="attack-controls">
                            <select id="newRole">
                                <option value="user">user</option>
                                <option value="admin">admin ‚òÖ</option>
                                <option value="superadmin">superadmin ‚òÖ‚òÖ</option>
                            </select>
                            <button class="btn btn-danger" id="executeAttack">üîì Execute Attack</button>
                        </div>
                    </div>

                    <div class="result-section hidden" id="attackResult">
                        <h4>‚ö° Forged Token</h4>
                        <div class="token-display forged">
                            <code id="forgedToken"></code>
                        </div>
                        <div class="token-decoded forged">
                            <span class="claim">alg: "none"</span>
                            <span class="claim" id="forgedRole">role: "admin"</span>
                        </div>
                        <div class="attack-explained">
                            <h4>‚ö†Ô∏è What Happened</h4>
                            <p>The "none" algorithm tells the server to <strong>skip signature verification</strong>. If
                                the server accepts this, an attacker can:</p>
                            <ul>
                                <li>Remove the signature entirely</li>
                                <li>Modify any claims (role, user, permissions)</li>
                                <li>Impersonate any user or gain admin access</li>
                            </ul>
                        </div>
                    </div>

                    <div class="defense-section">
                        <h4>üõ°Ô∏è How to Defend</h4>
                        <pre><code>// ALWAYS validate the algorithm explicitly!
const payload = jwt.verify(token, secret, {
  algorithms: ['HS256'], // Whitelist allowed algorithms
});

// NEVER do this:
const payload = jwt.decode(token); // No verification!</code></pre>
                    </div>
                </div>
            </section>

            <!-- Lab 2: JWT Secret Guessing -->
            <section class="lab-card glass-card">
                <div class="lab-header">
                    <span class="lab-number">Lab 2</span>
                    <h3>Weak Secret Cracking</h3>
                    <span class="difficulty medium">Intermediate</span>
                </div>

                <div class="lab-description">
                    <p>Weak JWT secrets can be brute-forced. This demo shows how quickly common passwords are cracked.
                    </p>
                </div>

                <div class="lab-demo">
                    <div class="demo-section">
                        <h4>üéØ Target Token</h4>
                        <p>Try to guess the secret used to sign this JWT:</p>
                        <div class="token-display">
                            <code>eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxMjM0In0.VFPaOXRopFxCZ...</code>
                        </div>
                    </div>

                    <div class="cracking-section">
                        <h4>üîì Brute Force Attack</h4>
                        <div class="wordlist">
                            <p>Trying common passwords:</p>
                            <div class="password-attempts" id="passwordAttempts">
                                <!-- Will be filled by JS -->
                            </div>
                        </div>
                        <button class="btn btn-danger" id="startCrack">üöÄ Start Cracking</button>
                        <div class="crack-result hidden" id="crackResult">
                            <span class="cracked">üîì SECRET FOUND: <strong id="crackedSecret">secret123</strong></span>
                            <span class="crack-time">Cracked in: <span id="crackTime">0.3</span> seconds</span>
                        </div>
                    </div>

                    <div class="defense-section">
                        <h4>üõ°Ô∏è How to Defend</h4>
                        <pre><code>// Use cryptographically random secrets (256+ bits)
const secret = crypto.randomBytes(32).toString('hex');
// Example: "a3f2b1c4d5e6f7g8h9i0j1k2l3m4n5o6"

// NEVER use:
const secret = "secret123"; // Cracked instantly
const secret = "password";  // Cracked instantly</code></pre>
                    </div>
                </div>
            </section>

            <!-- Lab 3: Algorithm Confusion -->
            <section class="lab-card glass-card">
                <div class="lab-header">
                    <span class="lab-number">Lab 3</span>
                    <h3>RS256 to HS256 Confusion</h3>
                    <span class="difficulty hard">Advanced</span>
                </div>

                <div class="lab-description">
                    <p>When a server uses RS256 (asymmetric), an attacker might trick it into accepting HS256
                        (symmetric) using the public key as the secret.</p>
                </div>

                <div class="lab-demo">
                    <div class="demo-section">
                        <h4>üí° The Concept</h4>
                        <div class="concept-grid">
                            <div class="concept-item">
                                <h5>RS256 (Normal)</h5>
                                <p>Private key signs</p>
                                <p>Public key verifies</p>
                            </div>
                            <div class="concept-arrow">‚Üí</div>
                            <div class="concept-item attack">
                                <h5>HS256 (Attack)</h5>
                                <p>Attacker gets public key</p>
                                <p>Signs token with it as HMAC secret</p>
                                <p>Server uses same "secret" to verify</p>
                            </div>
                        </div>
                    </div>

                    <div class="defense-section">
                        <h4>üõ°Ô∏è How to Defend</h4>
                        <pre><code>// Explicitly specify the expected algorithm
jwt.verify(token, publicKey, { 
  algorithms: ['RS256'] // Only accept RS256!
});

// Use different key types for different algorithms
// RSA key for RS256, symmetric secret for HS256</code></pre>
                    </div>
                </div>
            </section>

            <!-- Security Takeaways -->
            <section class="takeaways glass-card">
                <h2>üéì Key Takeaways</h2>
                <div class="takeaway-grid">
                    <div class="takeaway">
                        <span class="number">1</span>
                        <p>Always validate JWT signatures - never just decode</p>
                    </div>
                    <div class="takeaway">
                        <span class="number">2</span>
                        <p>Whitelist allowed algorithms explicitly</p>
                    </div>
                    <div class="takeaway">
                        <span class="number">3</span>
                        <p>Use cryptographically strong secrets (256+ bits)</p>
                    </div>
                    <div class="takeaway">
                        <span class="number">4</span>
                        <p>Use well-tested JWT libraries, not custom code</p>
                    </div>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p>Part of <a href="../index.html">Auth Academy</a> ‚Ä¢ Built with ‚ù§Ô∏è</p>
        </footer>
    </div>

    <script src="../shared/theme-manager.js"></script>
    <script src="app.js"></script>
</body>

</html>